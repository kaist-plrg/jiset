package kr.ac.kaist.jiset.parser

import kr.ac.kaist.jiset._
import kr.ac.kaist.jiset.util.Useful._
import scala.util.parsing.combinator.RegexParsers
import spray.json._

trait UnicodeRegex extends { _: RegexParsers =>
  // datas
  private val IDStartData: List[Any] =
    List(List(65, 90), List(97, 122), 170, 181, 186, List(192, 214), List(216, 246), List(248, 705), List(710, 721), List(736, 740), 748, 750, List(880, 884), List(886, 887), List(890, 893), 895, 902, List(904, 906), 908, List(910, 929), List(931, 1013), List(1015, 1153), List(1162, 1327), List(1329, 1366), 1369, List(1376, 1416), List(1488, 1514), List(1519, 1522), List(1568, 1610), List(1646, 1647), List(1649, 1747), 1749, List(1765, 1766), List(1774, 1775), List(1786, 1788), 1791, 1808, List(1810, 1839), List(1869, 1957), 1969, List(1994, 2026), List(2036, 2037), 2042, List(2048, 2069), 2074, 2084, 2088, List(2112, 2136), List(2144, 2154), List(2208, 2228), List(2230, 2247), List(2308, 2361), 2365, 2384, List(2392, 2401), List(2417, 2432), List(2437, 2444), List(2447, 2448), List(2451, 2472), List(2474, 2480), 2482, List(2486, 2489), 2493, 2510, List(2524, 2525), List(2527, 2529), List(2544, 2545), 2556, List(2565, 2570), List(2575, 2576), List(2579, 2600), List(2602, 2608), List(2610, 2611), List(2613, 2614), List(2616, 2617), List(2649, 2652), 2654, List(2674, 2676), List(2693, 2701), List(2703, 2705), List(2707, 2728), List(2730, 2736), List(2738, 2739), List(2741, 2745), 2749, 2768, List(2784, 2785), 2809, List(2821, 2828), List(2831, 2832), List(2835, 2856), List(2858, 2864), List(2866, 2867), List(2869, 2873), 2877, List(2908, 2909), List(2911, 2913), 2929, 2947, List(2949, 2954), List(2958, 2960), List(2962, 2965), List(2969, 2970), 2972, List(2974, 2975), List(2979, 2980), List(2984, 2986), List(2990, 3001), 3024, List(3077, 3084), List(3086, 3088), List(3090, 3112), List(3114, 3129), 3133, List(3160, 3162), List(3168, 3169), 3200, List(3205, 3212), List(3214, 3216), List(3218, 3240), List(3242, 3251), List(3253, 3257), 3261, 3294, List(3296, 3297), List(3313, 3314), List(3332, 3340), List(3342, 3344), List(3346, 3386), 3389, 3406, List(3412, 3414), List(3423, 3425), List(3450, 3455), List(3461, 3478), List(3482, 3505), List(3507, 3515), 3517, List(3520, 3526), List(3585, 3632), List(3634, 3635), List(3648, 3654), List(3713, 3714), 3716, List(3718, 3722), List(3724, 3747), 3749, List(3751, 3760), List(3762, 3763), 3773, List(3776, 3780), 3782, List(3804, 3807), 3840, List(3904, 3911), List(3913, 3948), List(3976, 3980), List(4096, 4138), 4159, List(4176, 4181), List(4186, 4189), 4193, List(4197, 4198), List(4206, 4208), List(4213, 4225), 4238, List(4256, 4293), 4295, 4301, List(4304, 4346), List(4348, 4680), List(4682, 4685), List(4688, 4694), 4696, List(4698, 4701), List(4704, 4744), List(4746, 4749), List(4752, 4784), List(4786, 4789), List(4792, 4798), 4800, List(4802, 4805), List(4808, 4822), List(4824, 4880), List(4882, 4885), List(4888, 4954), List(4992, 5007), List(5024, 5109), List(5112, 5117), List(5121, 5740), List(5743, 5759), List(5761, 5786), List(5792, 5866), List(5870, 5880), List(5888, 5900), List(5902, 5905), List(5920, 5937), List(5952, 5969), List(5984, 5996), List(5998, 6000), List(6016, 6067), 6103, 6108, List(6176, 6264), List(6272, 6312), 6314, List(6320, 6389), List(6400, 6430), List(6480, 6509), List(6512, 6516), List(6528, 6571), List(6576, 6601), List(6656, 6678), List(6688, 6740), 6823, List(6917, 6963), List(6981, 6987), List(7043, 7072), List(7086, 7087), List(7098, 7141), List(7168, 7203), List(7245, 7247), List(7258, 7293), List(7296, 7304), List(7312, 7354), List(7357, 7359), List(7401, 7404), List(7406, 7411), List(7413, 7414), 7418, List(7424, 7615), List(7680, 7957), List(7960, 7965), List(7968, 8005), List(8008, 8013), List(8016, 8023), 8025, 8027, 8029, List(8031, 8061), List(8064, 8116), List(8118, 8124), 8126, List(8130, 8132), List(8134, 8140), List(8144, 8147), List(8150, 8155), List(8160, 8172), List(8178, 8180), List(8182, 8188), 8305, 8319, List(8336, 8348), 8450, 8455, List(8458, 8467), 8469, List(8472, 8477), 8484, 8486, 8488, List(8490, 8505), List(8508, 8511), List(8517, 8521), 8526, List(8544, 8584), List(11264, 11310), List(11312, 11358), List(11360, 11492), List(11499, 11502), List(11506, 11507), List(11520, 11557), 11559, 11565, List(11568, 11623), 11631, List(11648, 11670), List(11680, 11686), List(11688, 11694), List(11696, 11702), List(11704, 11710), List(11712, 11718), List(11720, 11726), List(11728, 11734), List(11736, 11742), List(12293, 12295), List(12321, 12329), List(12337, 12341), List(12344, 12348), List(12353, 12438), List(12443, 12447), List(12449, 12538), List(12540, 12543), List(12549, 12591), List(12593, 12686), List(12704, 12735), List(12784, 12799), List(13312, 19903), List(19968, 40956), List(40960, 42124), List(42192, 42237), List(42240, 42508), List(42512, 42527), List(42538, 42539), List(42560, 42606), List(42623, 42653), List(42656, 42735), List(42775, 42783), List(42786, 42888), List(42891, 42943), List(42946, 42954), List(42997, 43009), List(43011, 43013), List(43015, 43018), List(43020, 43042), List(43072, 43123), List(43138, 43187), List(43250, 43255), 43259, List(43261, 43262), List(43274, 43301), List(43312, 43334), List(43360, 43388), List(43396, 43442), 43471, List(43488, 43492), List(43494, 43503), List(43514, 43518), List(43520, 43560), List(43584, 43586), List(43588, 43595), List(43616, 43638), 43642, List(43646, 43695), 43697, List(43701, 43702), List(43705, 43709), 43712, 43714, List(43739, 43741), List(43744, 43754), List(43762, 43764), List(43777, 43782), List(43785, 43790), List(43793, 43798), List(43808, 43814), List(43816, 43822), List(43824, 43866), List(43868, 43881), List(43888, 44002), List(44032, 55203), List(55216, 55238), List(55243, 55291), List(63744, 64109), List(64112, 64217), List(64256, 64262), List(64275, 64279), 64285, List(64287, 64296), List(64298, 64310), List(64312, 64316), 64318, List(64320, 64321), List(64323, 64324), List(64326, 64433), List(64467, 64829), List(64848, 64911), List(64914, 64967), List(65008, 65019), List(65136, 65140), List(65142, 65276), List(65313, 65338), List(65345, 65370), List(65382, 65470), List(65474, 65479), List(65482, 65487), List(65490, 65495), List(65498, 65500), List(65536, 65547), List(65549, 65574), List(65576, 65594), List(65596, 65597), List(65599, 65613), List(65616, 65629), List(65664, 65786), List(65856, 65908), List(66176, 66204), List(66208, 66256), List(66304, 66335), List(66349, 66378), List(66384, 66421), List(66432, 66461), List(66464, 66499), List(66504, 66511), List(66513, 66517), List(66560, 66717), List(66736, 66771), List(66776, 66811), List(66816, 66855), List(66864, 66915), List(67072, 67382), List(67392, 67413), List(67424, 67431), List(67584, 67589), 67592, List(67594, 67637), List(67639, 67640), 67644, List(67647, 67669), List(67680, 67702), List(67712, 67742), List(67808, 67826), List(67828, 67829), List(67840, 67861), List(67872, 67897), List(67968, 68023), List(68030, 68031), 68096, List(68112, 68115), List(68117, 68119), List(68121, 68149), List(68192, 68220), List(68224, 68252), List(68288, 68295), List(68297, 68324), List(68352, 68405), List(68416, 68437), List(68448, 68466), List(68480, 68497), List(68608, 68680), List(68736, 68786), List(68800, 68850), List(68864, 68899), List(69248, 69289), List(69296, 69297), List(69376, 69404), 69415, List(69424, 69445), List(69552, 69572), List(69600, 69622), List(69635, 69687), List(69763, 69807), List(69840, 69864), List(69891, 69926), 69956, 69959, List(69968, 70002), 70006, List(70019, 70066), List(70081, 70084), 70106, 70108, List(70144, 70161), List(70163, 70187), List(70272, 70278), 70280, List(70282, 70285), List(70287, 70301), List(70303, 70312), List(70320, 70366), List(70405, 70412), List(70415, 70416), List(70419, 70440), List(70442, 70448), List(70450, 70451), List(70453, 70457), 70461, 70480, List(70493, 70497), List(70656, 70708), List(70727, 70730), List(70751, 70753), List(70784, 70831), List(70852, 70853), 70855, List(71040, 71086), List(71128, 71131), List(71168, 71215), 71236, List(71296, 71338), 71352, List(71424, 71450), List(71680, 71723), List(71840, 71903), List(71935, 71942), 71945, List(71948, 71955), List(71957, 71958), List(71960, 71983), 71999, 72001, List(72096, 72103), List(72106, 72144), 72161, 72163, 72192, List(72203, 72242), 72250, 72272, List(72284, 72329), 72349, List(72384, 72440), List(72704, 72712), List(72714, 72750), 72768, List(72818, 72847), List(72960, 72966), List(72968, 72969), List(72971, 73008), 73030, List(73056, 73061), List(73063, 73064), List(73066, 73097), 73112, List(73440, 73458), 73648, List(73728, 74649), List(74752, 74862), List(74880, 75075), List(77824, 78894), List(82944, 83526), List(92160, 92728), List(92736, 92766), List(92880, 92909), List(92928, 92975), List(92992, 92995), List(93027, 93047), List(93053, 93071), List(93760, 93823), List(93952, 94026), 94032, List(94099, 94111), List(94176, 94177), 94179, List(94208, 100343), List(100352, 101589), List(101632, 101640), List(110592, 110878), List(110928, 110930), List(110948, 110951), List(110960, 111355), List(113664, 113770), List(113776, 113788), List(113792, 113800), List(113808, 113817), List(119808, 119892), List(119894, 119964), List(119966, 119967), 119970, List(119973, 119974), List(119977, 119980), List(119982, 119993), 119995, List(119997, 120003), List(120005, 120069), List(120071, 120074), List(120077, 120084), List(120086, 120092), List(120094, 120121), List(120123, 120126), List(120128, 120132), 120134, List(120138, 120144), List(120146, 120485), List(120488, 120512), List(120514, 120538), List(120540, 120570), List(120572, 120596), List(120598, 120628), List(120630, 120654), List(120656, 120686), List(120688, 120712), List(120714, 120744), List(120746, 120770), List(120772, 120779), List(123136, 123180), List(123191, 123197), 123214, List(123584, 123627), List(124928, 125124), List(125184, 125251), 125259, List(126464, 126467), List(126469, 126495), List(126497, 126498), 126500, 126503, List(126505, 126514), List(126516, 126519), 126521, 126523, 126530, 126535, 126537, 126539, List(126541, 126543), List(126545, 126546), 126548, 126551, 126553, 126555, 126557, 126559, List(126561, 126562), 126564, List(126567, 126570), List(126572, 126578), List(126580, 126583), List(126585, 126588), 126590, List(126592, 126601), List(126603, 126619), List(126625, 126627), List(126629, 126633), List(126635, 126651), List(131072, 173789), List(173824, 177972), List(177984, 178205), List(178208, 183969), List(183984, 191456), List(194560, 195101), List(196608, 201546))

  private val IDContinueData =
    List(List(65, 90), List(97, 122), 170, 181, 186, List(192, 214), List(216, 246), List(248, 705), List(710, 721), List(736, 740), 748, 750, List(880, 884), List(886, 887), List(890, 893), 895, 902, List(904, 906), 908, List(910, 929), List(931, 1013), List(1015, 1153), List(1162, 1327), List(1329, 1366), 1369, List(1376, 1416), List(1488, 1514), List(1519, 1522), List(1568, 1610), List(1646, 1647), List(1649, 1747), 1749, List(1765, 1766), List(1774, 1775), List(1786, 1788), 1791, 1808, List(1810, 1839), List(1869, 1957), 1969, List(1994, 2026), List(2036, 2037), 2042, List(2048, 2069), 2074, 2084, 2088, List(2112, 2136), List(2144, 2154), List(2208, 2228), List(2230, 2247), List(2308, 2361), 2365, 2384, List(2392, 2401), List(2417, 2432), List(2437, 2444), List(2447, 2448), List(2451, 2472), List(2474, 2480), 2482, List(2486, 2489), 2493, 2510, List(2524, 2525), List(2527, 2529), List(2544, 2545), 2556, List(2565, 2570), List(2575, 2576), List(2579, 2600), List(2602, 2608), List(2610, 2611), List(2613, 2614), List(2616, 2617), List(2649, 2652), 2654, List(2674, 2676), List(2693, 2701), List(2703, 2705), List(2707, 2728), List(2730, 2736), List(2738, 2739), List(2741, 2745), 2749, 2768, List(2784, 2785), 2809, List(2821, 2828), List(2831, 2832), List(2835, 2856), List(2858, 2864), List(2866, 2867), List(2869, 2873), 2877, List(2908, 2909), List(2911, 2913), 2929, 2947, List(2949, 2954), List(2958, 2960), List(2962, 2965), List(2969, 2970), 2972, List(2974, 2975), List(2979, 2980), List(2984, 2986), List(2990, 3001), 3024, List(3077, 3084), List(3086, 3088), List(3090, 3112), List(3114, 3129), 3133, List(3160, 3162), List(3168, 3169), 3200, List(3205, 3212), List(3214, 3216), List(3218, 3240), List(3242, 3251), List(3253, 3257), 3261, 3294, List(3296, 3297), List(3313, 3314), List(3332, 3340), List(3342, 3344), List(3346, 3386), 3389, 3406, List(3412, 3414), List(3423, 3425), List(3450, 3455), List(3461, 3478), List(3482, 3505), List(3507, 3515), 3517, List(3520, 3526), List(3585, 3632), List(3634, 3635), List(3648, 3654), List(3713, 3714), 3716, List(3718, 3722), List(3724, 3747), 3749, List(3751, 3760), List(3762, 3763), 3773, List(3776, 3780), 3782, List(3804, 3807), 3840, List(3904, 3911), List(3913, 3948), List(3976, 3980), List(4096, 4138), 4159, List(4176, 4181), List(4186, 4189), 4193, List(4197, 4198), List(4206, 4208), List(4213, 4225), 4238, List(4256, 4293), 4295, 4301, List(4304, 4346), List(4348, 4680), List(4682, 4685), List(4688, 4694), 4696, List(4698, 4701), List(4704, 4744), List(4746, 4749), List(4752, 4784), List(4786, 4789), List(4792, 4798), 4800, List(4802, 4805), List(4808, 4822), List(4824, 4880), List(4882, 4885), List(4888, 4954), List(4992, 5007), List(5024, 5109), List(5112, 5117), List(5121, 5740), List(5743, 5759), List(5761, 5786), List(5792, 5866), List(5870, 5880), List(5888, 5900), List(5902, 5905), List(5920, 5937), List(5952, 5969), List(5984, 5996), List(5998, 6000), List(6016, 6067), 6103, 6108, List(6176, 6264), List(6272, 6312), 6314, List(6320, 6389), List(6400, 6430), List(6480, 6509), List(6512, 6516), List(6528, 6571), List(6576, 6601), List(6656, 6678), List(6688, 6740), 6823, List(6917, 6963), List(6981, 6987), List(7043, 7072), List(7086, 7087), List(7098, 7141), List(7168, 7203), List(7245, 7247), List(7258, 7293), List(7296, 7304), List(7312, 7354), List(7357, 7359), List(7401, 7404), List(7406, 7411), List(7413, 7414), 7418, List(7424, 7615), List(7680, 7957), List(7960, 7965), List(7968, 8005), List(8008, 8013), List(8016, 8023), 8025, 8027, 8029, List(8031, 8061), List(8064, 8116), List(8118, 8124), 8126, List(8130, 8132), List(8134, 8140), List(8144, 8147), List(8150, 8155), List(8160, 8172), List(8178, 8180), List(8182, 8188), 8305, 8319, List(8336, 8348), 8450, 8455, List(8458, 8467), 8469, List(8472, 8477), 8484, 8486, 8488, List(8490, 8505), List(8508, 8511), List(8517, 8521), 8526, List(8544, 8584), List(11264, 11310), List(11312, 11358), List(11360, 11492), List(11499, 11502), List(11506, 11507), List(11520, 11557), 11559, 11565, List(11568, 11623), 11631, List(11648, 11670), List(11680, 11686), List(11688, 11694), List(11696, 11702), List(11704, 11710), List(11712, 11718), List(11720, 11726), List(11728, 11734), List(11736, 11742), List(12293, 12295), List(12321, 12329), List(12337, 12341), List(12344, 12348), List(12353, 12438), List(12443, 12447), List(12449, 12538), List(12540, 12543), List(12549, 12591), List(12593, 12686), List(12704, 12735), List(12784, 12799), List(13312, 19903), List(19968, 40956), List(40960, 42124), List(42192, 42237), List(42240, 42508), List(42512, 42527), List(42538, 42539), List(42560, 42606), List(42623, 42653), List(42656, 42735), List(42775, 42783), List(42786, 42888), List(42891, 42943), List(42946, 42954), List(42997, 43009), List(43011, 43013), List(43015, 43018), List(43020, 43042), List(43072, 43123), List(43138, 43187), List(43250, 43255), 43259, List(43261, 43262), List(43274, 43301), List(43312, 43334), List(43360, 43388), List(43396, 43442), 43471, List(43488, 43492), List(43494, 43503), List(43514, 43518), List(43520, 43560), List(43584, 43586), List(43588, 43595), List(43616, 43638), 43642, List(43646, 43695), 43697, List(43701, 43702), List(43705, 43709), 43712, 43714, List(43739, 43741), List(43744, 43754), List(43762, 43764), List(43777, 43782), List(43785, 43790), List(43793, 43798), List(43808, 43814), List(43816, 43822), List(43824, 43866), List(43868, 43881), List(43888, 44002), List(44032, 55203), List(55216, 55238), List(55243, 55291), List(63744, 64109), List(64112, 64217), List(64256, 64262), List(64275, 64279), 64285, List(64287, 64296), List(64298, 64310), List(64312, 64316), 64318, List(64320, 64321), List(64323, 64324), List(64326, 64433), List(64467, 64829), List(64848, 64911), List(64914, 64967), List(65008, 65019), List(65136, 65140), List(65142, 65276), List(65313, 65338), List(65345, 65370), List(65382, 65470), List(65474, 65479), List(65482, 65487), List(65490, 65495), List(65498, 65500), List(65536, 65547), List(65549, 65574), List(65576, 65594), List(65596, 65597), List(65599, 65613), List(65616, 65629), List(65664, 65786), List(65856, 65908), List(66176, 66204), List(66208, 66256), List(66304, 66335), List(66349, 66378), List(66384, 66421), List(66432, 66461), List(66464, 66499), List(66504, 66511), List(66513, 66517), List(66560, 66717), List(66736, 66771), List(66776, 66811), List(66816, 66855), List(66864, 66915), List(67072, 67382), List(67392, 67413), List(67424, 67431), List(67584, 67589), 67592, List(67594, 67637), List(67639, 67640), 67644, List(67647, 67669), List(67680, 67702), List(67712, 67742), List(67808, 67826), List(67828, 67829), List(67840, 67861), List(67872, 67897), List(67968, 68023), List(68030, 68031), 68096, List(68112, 68115), List(68117, 68119), List(68121, 68149), List(68192, 68220), List(68224, 68252), List(68288, 68295), List(68297, 68324), List(68352, 68405), List(68416, 68437), List(68448, 68466), List(68480, 68497), List(68608, 68680), List(68736, 68786), List(68800, 68850), List(68864, 68899), List(69248, 69289), List(69296, 69297), List(69376, 69404), 69415, List(69424, 69445), List(69552, 69572), List(69600, 69622), List(69635, 69687), List(69763, 69807), List(69840, 69864), List(69891, 69926), 69956, 69959, List(69968, 70002), 70006, List(70019, 70066), List(70081, 70084), 70106, 70108, List(70144, 70161), List(70163, 70187), List(70272, 70278), 70280, List(70282, 70285), List(70287, 70301), List(70303, 70312), List(70320, 70366), List(70405, 70412), List(70415, 70416), List(70419, 70440), List(70442, 70448), List(70450, 70451), List(70453, 70457), 70461, 70480, List(70493, 70497), List(70656, 70708), List(70727, 70730), List(70751, 70753), List(70784, 70831), List(70852, 70853), 70855, List(71040, 71086), List(71128, 71131), List(71168, 71215), 71236, List(71296, 71338), 71352, List(71424, 71450), List(71680, 71723), List(71840, 71903), List(71935, 71942), 71945, List(71948, 71955), List(71957, 71958), List(71960, 71983), 71999, 72001, List(72096, 72103), List(72106, 72144), 72161, 72163, 72192, List(72203, 72242), 72250, 72272, List(72284, 72329), 72349, List(72384, 72440), List(72704, 72712), List(72714, 72750), 72768, List(72818, 72847), List(72960, 72966), List(72968, 72969), List(72971, 73008), 73030, List(73056, 73061), List(73063, 73064), List(73066, 73097), 73112, List(73440, 73458), 73648, List(73728, 74649), List(74752, 74862), List(74880, 75075), List(77824, 78894), List(82944, 83526), List(92160, 92728), List(92736, 92766), List(92880, 92909), List(92928, 92975), List(92992, 92995), List(93027, 93047), List(93053, 93071), List(93760, 93823), List(93952, 94026), 94032, List(94099, 94111), List(94176, 94177), 94179, List(94208, 100343), List(100352, 101589), List(101632, 101640), List(110592, 110878), List(110928, 110930), List(110948, 110951), List(110960, 111355), List(113664, 113770), List(113776, 113788), List(113792, 113800), List(113808, 113817), List(119808, 119892), List(119894, 119964), List(119966, 119967), 119970, List(119973, 119974), List(119977, 119980), List(119982, 119993), 119995, List(119997, 120003), List(120005, 120069), List(120071, 120074), List(120077, 120084), List(120086, 120092), List(120094, 120121), List(120123, 120126), List(120128, 120132), 120134, List(120138, 120144), List(120146, 120485), List(120488, 120512), List(120514, 120538), List(120540, 120570), List(120572, 120596), List(120598, 120628), List(120630, 120654), List(120656, 120686), List(120688, 120712), List(120714, 120744), List(120746, 120770), List(120772, 120779), List(123136, 123180), List(123191, 123197), 123214, List(123584, 123627), List(124928, 125124), List(125184, 125251), 125259, List(126464, 126467), List(126469, 126495), List(126497, 126498), 126500, 126503, List(126505, 126514), List(126516, 126519), 126521, 126523, 126530, 126535, 126537, 126539, List(126541, 126543), List(126545, 126546), 126548, 126551, 126553, 126555, 126557, 126559, List(126561, 126562), 126564, List(126567, 126570), List(126572, 126578), List(126580, 126583), List(126585, 126588), 126590, List(126592, 126601), List(126603, 126619), List(126625, 126627), List(126629, 126633), List(126635, 126651), List(131072, 173789), List(173824, 177972), List(177984, 178205), List(178208, 183969), List(183984, 191456), List(194560, 195101), List(196608, 201546))

  // decode dat
  private def decode(data: List[Any]): Set[Int] = (data.flatMap {
    case n: Int => List(n)
    case List(s: Int, e: Int) => (s to e).toList
    case _ => ???
  }).toSet

  // special characters
  lazy val ZWNJ = "\u200C"
  lazy val ZWJ = "\u200D"
  lazy val ZWNBSP = "\uFEFF"

  lazy val TAB = "\u0009"
  lazy val VT = "\u000B"
  lazy val FF = "\u000C"
  lazy val SP = "\u0020"
  lazy val NBSP = "\u00A0"
  lazy val USP = "[\u1680\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000]".r

  lazy val LF = "\u000A"
  lazy val CR = "\u000D"
  lazy val LS = "\u2028"
  lazy val PS = "\u2029"

  lazy val lines = "[\u000A\u000D\u2028\u2029]".r

  lazy val Unicode = "(?s).".r

  lazy val Comment = """/\*+[^*]*\*+(?:[^/*][^*]*\*+)*/|//[^\u000A\u000D\u2028\u2029]*""".r

  private val IDStartSet: Set[Int] = decode(IDStartData)
  val IDStart = Unicode.filter(s => IDStartSet contains toCodePoint(s))
  private val IDContinueSet: Set[Int] = decode(IDContinueData)
  val IDContinue = Unicode.filter(s => IDContinueSet contains toCodePoint(s))

  private def toCodePoint(str: String): Int = {
    val codePoints = (0 until str.length).toList.map(str.codePointAt(_))
    codePoints.foldLeft(0)(_ * (1 << 16) + _)
  }
}
